# Firebase Setup Guide

This guide will help you set up Firebase for your React Native app with the complete collection structure.

## Prerequisites

1. Make sure you have the following packages installed:

```bash
npm install @react-native-firebase/app @react-native-firebase/firestore
```

## Firebase Project Setup

### 1. Create Firebase Project

1. Go to [Firebase Console](https://console.firebase.google.com/)
2. Click "Add project"
3. Enter your project name
4. Follow the setup wizard

### 2. Skip Authentication (Optional)

For now, the app uses a demo user ID. You can add authentication later when needed.

### 3. Enable Firestore Database

1. In Firebase Console, go to "Firestore Database"
2. Click "Create database"
3. Choose "Start in test mode" (for development)
4. Select a location for your database

### 4. Set Up Security Rules

In Firestore Database > Rules, use these rules for development:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Allow all read/write for development (change this for production)
    match /{document=**} {
      allow read, write: if true;
    }
  }
}
```

## Collection Structure

The app creates the following Firebase collections:

### üìò users (Collection)

- **Document ID**: Auto-generated by Firestore (user's UID)
- **Fields**:
  - `email`: string
  - `displayName`: string
  - `profileCreatedAt`: timestamp
  - `lastUpdatedAt`: timestamp
  - `emotionalProfile`: map
    - `currentMood`: string
    - `moodFrequency`: string
    - `emotionalNeeds`: string
  - `compatibilityScore`: number
  - `pointsProfile`: map
    - `totalPoints`: number
    - `level`: string
  - `userSettings`: map
    - `notificationsEnabled`: boolean
    - `theme`: string

### üìÅ Subcollections under users/{userId}:

#### PersonalityTraits

- **Document ID**: Auto-generated
- **Fields**:
  - `openness`: number (1-10)
  - `neuroticism`: number (1-10)
  - `agreeableness`: number (1-10)
  - `timestamp`: timestamp

#### MoodHistory

- **Document ID**: Auto-generated
- **Fields**:
  - `mood`: string
  - `notes`: string
  - `timestamp`: timestamp

#### PointsTransactions

- **Document ID**: Auto-generated
- **Fields**:
  - `points`: number
  - `type`: "earned" | "spent"
  - `reason`: string
  - `timestamp`: timestamp

#### QuestResponses

- **Document ID**: Auto-generated
- **Fields**:
  - `questId`: string (reference to Quests collection)
  - `response`: string
  - `timestamp`: timestamp

### üìò Quests (Collection)

- **Document ID**: Auto-generated
- **Fields**:
  - `questionText`: string
  - `category`: string
  - `options`: array of strings
  - `pointValue`: number

## Usage

### 1. Demo User

The app currently uses a demo user ID for testing. All data will be saved under this demo user.

### 2. User Profile Form

The `UserProfileForm` component provides input fields for:

- Basic user information
- Emotional profile
- Points and level
- User settings
- Personality traits
- Mood tracking
- Points transactions
- Quest responses

### 3. Firebase Service

The `firebaseService.ts` file contains all Firebase operations:

- User profile management
- Subcollection operations
- Data retrieval and updates
- Utility functions

## Features

### Automatic Points Management

- Points transactions automatically update the user's total points
- Earned points are added, spent points are subtracted
- Total points cannot go below 0

### Real-time Data

- All data is stored in Firestore with timestamps
- Demo user ID for testing purposes
- Simple data access for development

### Data Validation

- Input validation for all form fields
- Error handling for Firebase operations
- User-friendly error messages

## Testing

1. Run the app: `npm start`
2. Navigate to the Profile tab
3. Fill out the forms and save data
4. Check Firebase Console to see the data being created

## Security Notes

- Currently using demo user ID for development
- Firestore security rules allow all read/write for testing
- Add proper authentication and security rules for production
- Sensitive operations should be handled server-side

## Troubleshooting

### Common Issues:

1. **Permission Denied**: Check Firestore security rules
2. **Network Errors**: Ensure proper internet connection
3. **Package Not Found**: Run `npm install` to install dependencies

### Debug Mode:

- Check console logs for detailed error messages
- Use Firebase Console to monitor database operations
- Enable Firebase Analytics for usage tracking
 